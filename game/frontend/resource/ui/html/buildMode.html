<html>
	<head>
		<link rel="stylesheet" type="text/css" href="hud.css"></link>
		<script src="hud.js"></script>
		<script>

			var mode = arcadeHud.getParameterByName("mode");
			var isDoingStuff = false;
			var g_allowTransformUpdate = true;
			var sourcePlatformId = "-KJvcne3IKMZQTaG7lPo";
			var libraryBrowserContext;
			var category;
			var titleElem;
			var entryContainerElem;
			var searchCategory;
			var response;
			var method;
			var transformInfo;
			var wl_transformContainer;

			var cmdListener = {
				"displayMode": "browse",
				"specialWheel": function(delta)
				{
					console.log("SPECIAL WHEEEEL IT " + delta);
				}, 
				"setRotationAxis": function(axis)
				{
					console.log("SET ROTATION AXISSSSS: " + axis);
				},
				"switchMode": function(mode)
				{
					var entryContainerElem = document.querySelector("#entryContainer");
					var transformMenuContainerElem = document.querySelector("#transformMenuContainer");

					if( mode === "browse" )
					{
						entryContainerElem.style.display = "block";
						transformMenuContainerElem.style.display = "none";
					}
					else if( mode === "transform" )
					{
						entryContainerElem.style.display = "none";
						transformMenuContainerElem.style.display = "block";
					}

					this.displayMode = mode;
				}
			};
		</script>

		<style>
			/*
			#pageContent
			{
				display: none;
				margin: 0;
				padding: 0;
				left: 0;
				right: 0;
				top: 0;
				bottom: 0;
			}
			*/

			.hiddenElem
			{
				display: none;
			}

			.hudSideContainer
			{
				position: fixed;
				left: 0;
				top: 50%;
				-webkit-transform: translate(0, -50%);
			}

			.hudSideContainerRow
			{
				display: block;
			}

			.hudSideContainerButton
			{
				font-size: 40px;
				background-color: rgba(250, 50, 50, 0.7);/*rgba(150, 150, 150, 0.5);*/
				border-radius: 0 10px 10px 0;
				border: 2px solid #000;
				border-left: 0;
				padding-right: 5px;
				padding-left: 5px;
				font-family: Arial;
				font-weight: 900;
				display: inline-block;
				height: 50px;
				/*width: 40px;*/
				text-align: center;
				white-space: nowrap;
				width: 40px;
				overflow: hidden;
				cursor: pointer;
				-webkit-transition: width 0.3s;
			}

			.hudSideContainerButton ~ .hudSideContainerButton
			{
				pointer-events: none;
				width: 1px;
			}

			.hudSideContainerButton ~ .hudSideContainerButton table
			{
				display: none;
			}

			.activeHudRow .hudSideContainerButton ~ .hudSideContainerButton
			{
				pointer-events: all;
				width: 40px;
			}

			.activeHudRow .hudSideContainerButton ~ .hudSideContainerButton table
			{
				display: table;
			}

			.hudSideContainerRow:hover .hudSideContainerButton:hover ~ .hudSideContainerButton
			{
				width: 40px;
				pointer-events: all;
			}

			.hudSideContainerRow:hover .hudSideContainerButton ~ .hudSideContainerButton:hover
			{
				width: 200px;
				pointer-events: all;
			}

			.hudSideContainerButton:hover
			{
				background-color: rgba(250, 50, 50, 0.9);
				width: 200px;
			}

			.hudSideContainerButton .buttonText
			{
				display: none;
				white-space: nowrap;
				font-size: 26px;
				text-align: center;
				vertical-align: middle;
				font-family: Arial;
				padding: 5px;
				font-style: italic;
				text-shadow: 2px 2px 2px #000;
				font-weight: bold;
				padding: 0;
				margin: 0;
			}

			.hudSideContainerButton:hover .buttonText
			{
				display: inline;
			}
/*
			.hudSideContainerRow .hudSideContainerButton img
			{
				display: inline;
			}

			.hudSideContainerRow:hover .hudSideContainerButton img
			{
				display: none;
			}

			.hudSideContainerRow .hudSideContainerButton .buttonText
			{
				display: none;
			}

			.hudSideContainerRow:hover .hudSideContainerButton .buttonText
			{
				display: inline;
			}

			.hudSideContainerButton:hover .buttonText
			{
				display: inline;
			}
			*/
/*
			.hudSideContainerButton + #metaSearchButton table
			{
				display: none;
			}

			.hudSideContainerButton:hover + #metaSearchButton table
			{
				display: table;
			}

			.hudSideContainerButton + #metaSearchButton:hover table
			{
				display: table;
			}

			.hudSideContainerButton buttonText
			{
				display: inline-block;
			}
*/
			#hudSideScrapeContainer
			{
				display: none;
				position: fixed;
				bottom: 15%;
				left: 0;
				color: #fff;
				text-shadow: 2px 2px 2px #000;
				font-weight: bold;
				font-family: Arial;
				text-align: center;

				/*
				border: 3px solid rgba(0, 0, 0, 1.0);
				border-top-left-radius: 10px;
				border-top-right-radius: 10px;
				background-color: rgba(50, 50, 50, 0.95);
				padding-bottom: 30px;
				padding: 6px;
				border: 20px solid pink;
				*/
			}

			.hudSideScrapeContainerButton
			{
				display: table-cell;
				pointer-events: auto;
				vertical-align: middle;
				font-size: 20px;
				white-space: nowrap;
				/*background-color: rgba(150, 150, 150, 0.5);*/
				background-color: rgba(0, 0, 255, 0.9);
				border-radius: 0 10px 10px 0 !important;
				border: 2px solid #000;
				border-left: 0;
				text-align: center;
				padding-left: 15px;
				padding-right: 15px;
				padding-top: 2px;
				padding-bottom: 4px;
				font-style: italic;
				text-shadow: 2px 2px 2px #000;
				font-weight: bold;
				-webkit-box-shadow: 3px 5px 8px #000;
			}

			.hudSideScrapeContainerButton .buttonText
			{
				display: none;
				white-space: nowrap;
				font-size: 26px;
				text-align: center;
				vertical-align: middle;
				font-family: Arial;
				padding: 5px;
				font-style: italic;
				text-shadow: 2px 2px 2px #000;
				font-weight: bold;
				padding: 0;
				margin: 0;
			}
		</style>
	</head>
	<body style="background-color: transparent;" class="hiddenElem">
		<style>
			#entryContainer::-webkit-scrollbar
			{
				width: 15px;
				height: 15px;
			}

			#entryContainer::-webkit-scrollbar-track
			{
				-webkit-box-shadow: inset 0 0 6px rgba(250, 50, 50, 0.7);
				border-radius: 10px;
				background-color: #000;/* rgba(250, 50, 50, 0.7);*//*rgba(100, 100, 100, 1.0);*/
			}

			#entryContainer::-webkit-scrollbar-thumb
			{
				border-radius: 10px;
				-webkit-box-shadow: inset 0 0 6px #000;/*rgba(200,200,200,1);*/
				background-color: rgba(250, 50, 50, 0.7);
			}

			#entryContainer::-webkit-scrollbar-corner
			{
				background-color: transparent;
			}

			.namePlate
			{
				color: rgba(255, 255, 255, 0.5);
				display: inline-block;
				padding: 8px;
				background-color: rgba(0, 0, 0, 0.99);
				border-top-left-radius: 10px;
				border-bottom-left-radius: 10px;
				border: 2px solid rgba(250, 50, 50, 0.7);/*rgb(100, 100, 100);*/
				border-right: 1px solid rgba(250, 50, 50, 0.7);/*rgb(100, 100, 100);*/
				margin-bottom: 4px;
				margin-top: 4px;
				border-left: 20px solid rgba(250, 50, 50, 0.7);/*rgb(100, 100, 100);*/
				letter-spacing: 0.1em;
				font-style: italic;
				opacity: 0.8;
				-webkit-transition: border 0.5s ease-in-out, border-right 0.5s ease-in-out;
			}

			.selectedNamePlate
			{
				color: #fff;
				-webkit-transition-delay: 0s, 0.5s;
				opacity: 1.0;
				border: 2px solid rgba(250, 50, 50, 0.9);/*rgb(255, 255, 255);*/
				border-left: 40px solid rgba(250, 50, 50, 0.9);/*rgb(255, 255, 255);*/
				border-right: 80px solid rgba(250, 50, 50, 0.9);/*rgb(255, 255, 255);*/
			}

			#title
			{
				line-height: 74px;
				font-family: Arial;
				font-size: 50px;
				padding-right: 10px;
				font-weight: 900;
				-webkit-text-stroke: 2px black;
				text-shadow:
       3px 3px 0 #000,
     -1px -1px 0 #000,  
      1px -1px 0 #000,
      -1px 1px 0 #000,
       1px 1px 0 #000;
/* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#000000+0,000000+100&0+0,0.5+25,0.9+75 */
background: -moz-linear-gradient(left,  rgba(0,0,0,0) 0%, rgba(0,0,0,0.5) 25%, rgba(0,0,0,0.9) 75%, rgba(0,0,0,0.9) 100%); /* FF3.6-15 */
background: -webkit-linear-gradient(left,  rgba(0,0,0,0) 0%,rgba(0,0,0,0.5) 25%,rgba(0,0,0,0.9) 75%,rgba(0,0,0,0.9) 100%); /* Chrome10-25,Safari5.1-6 */
background: linear-gradient(to right,  rgba(0,0,0,0) 0%,rgba(0,0,0,0.5) 25%,rgba(0,0,0,0.9) 75%,rgba(0,0,0,0.9) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#00000000', endColorstr='#e6000000',GradientType=1 ); /* IE6-9 */

			}

			#titleRule
			{
				position: fixed;
				top: 74px;
				right: 0;
				height: 4px;
				width: 50%;
				/* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#fa3232+0,fa3232+100&0+0,0.5+25,0.9+75 */
background: -moz-linear-gradient(left,  rgba(250,50,50,0) 0%, rgba(250,50,50,0.5) 25%, rgba(250,50,50,0.9) 75%, rgba(250,50,50,0.9) 100%); /* FF3.6-15 */
background: -webkit-linear-gradient(left,  rgba(250,50,50,0) 0%,rgba(250,50,50,0.5) 25%,rgba(250,50,50,0.9) 75%,rgba(250,50,50,0.9) 100%); /* Chrome10-25,Safari5.1-6 */
background: linear-gradient(to right,  rgba(250,50,50,0) 0%,rgba(250,50,50,0.5) 25%,rgba(250,50,50,0.9) 75%,rgba(250,50,50,0.9) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#00fa3232', endColorstr='#e6fa3232',GradientType=1 ); /* IE6-9 */

			}

			.rotateArrow
			{
				font-weight: 900;
				display: inline-block;
				font-size: 24px;
			}
		</style>

		<!--<div id="pageContent">-->
			<div id="title" style="position: fixed; top: 0; right: 0; width: 50%; height: 74px; text-align: right;"></div>
			<div id="titleRule"></div>
			<div id="entryContainer" style="font-size: 20px; font-weight: 900; position: fixed; top: 80px; bottom: 0; right: 0; margin: 0; text-align: right; border: 0; color: #fff; overflow-y: scroll; font-family: Arial;"></div>

			<div id="transformMenuContainer" style="display: none;">
				<div id="transformMenu">
					<table>
						<tr><td style="width: 250px;">
							<div id="wl_transform" class="wlContainer" style="height: 220px;">
								<div class="wlEntry">
									<div class="wlPlate wlPlateSelected" name="rotateTab" onclick="selectPlate(this);">
										Rotate
									</div><br />
									<div class="wlPlate" name="offsetTab" onclick="selectPlate(this);">
										Offset
									</div><br />
									<div class="wlPlate" name="scaleTab" onclick="selectPlate(this);">
										Scale
									</div><br />
									<div class="wlPlate" name="scaleTab" onclick="resetTransform(this);">
										Reset
									</div><br />
								</div>
							</div>
						</td><td valign="top">
							<div class="optSliderPanel" id="rotationPanel">
								<table>
									<tr><td valign="middle" width="90">
										<div class="rotateArrow" onclick="optResetvalue(this.nextSibling, -90);">&#8630;</div><div class="optLabel" name="pitch_label" onclick="optResetvalue(this);">P</div><div class="rotateArrow" onclick="optResetvalue(this.previousSibling, 90);">&#8631;</div>
									</td><td>
										<input type="range" name="pitch" oninput="optSliderOnInput(this);" min="-179" max="180" step="1" value="0" style="width: 300px;" />
									</td><td>
										<div class="optValue" name="pitch_value" style="text-align: left; width: 100px;">0&deg;</div>
									</td></tr>
									<tr><td valign="middle">
										<div class="rotateArrow" onclick="optResetvalue(this.nextSibling, -90);">&#8630;</div><div class="optLabel" name="yaw_label" onclick="optResetvalue(this);">Y</div><div class="rotateArrow" onclick="optResetvalue(this.previousSibling, 90);">&#8631;</div>
									</td><td>
										<input type="range" name="yaw" oninput="optSliderOnInput(this);" min="-179" max="180" step="1" value="0" style="width: 300px;" />
									</td><td>
										<div class="optValue" name="yaw_value" style="text-align: left; width: 100px;">0&deg;</div>
									</td></tr>
									<tr><td valign="middle">
										<div class="rotateArrow" onclick="optResetvalue(this.nextSibling, 90);">&#8630;</div><div class="optLabel" name="roll_label" onclick="optResetvalue(this);">R</div><div class="rotateArrow" onclick="optResetvalue(this.previousSibling, -90);">&#8631;</div>
									</td><td>
										<input type="range" name="roll" oninput="optSliderOnInput(this);" min="-179" max="180" step="1" value="0" style="width: 300px;" />
									</td><td>
										<div class="optValue" name="roll_value" style="text-align: left; width: 100px;">0&deg;</div>
									</td></tr>
								</table>
							</div>
							<div class="optSliderPanel" id="offsetPanel" style="display: none;">
								<table>
									<tr><td valign="middle">
										<div class="optLabel" name="offX_label" onclick="optResetvalue(this);">X</div>
									</td><td>
										<input type="range" name="offX" oninput="optSliderOnInput(this);" min="-200" max="200" step="1" value="0" style="width: 300px;" />
									</td><td>
										<div class="optValue" name="offX_value" style="text-align: left; width: 100px;">0in</div>
									</td></tr>
									<tr><td valign="middle">
										<div class="optLabel" name="offY_label" onclick="optResetvalue(this);">Y</div>
									</td><td>
										<input type="range" name="offY" oninput="optSliderOnInput(this);" min="-200" max="200" step="1" value="0" style="width: 300px;" />
									</td><td>
										<div class="optValue" name="offY_value" style="text-align: left; width: 100px;">0in</div>
									</td></tr>
									<tr><td valign="middle">
										<div class="optLabel" name="offZ_label" onclick="optResetvalue(this);">Z</div>
									</td><td>
										<input type="range" name="offZ" oninput="optSliderOnInput(this);" min="-200" max="200" step="1" value="0" style="width: 300px;" />
									</td><td>
										<div class="optValue" name="offZ_value" style="text-align: left; width: 100px;">0in</div>
									</td></tr>
								</table>
							</div>
							<div class="optSliderPanel" id="scalePanel" style="display: none;">
								<table>
									<tr><td valign="middle">
										<div class="optLabel" name="scale_label" onclick="optResetvalue(this);">&lrtri;</div>
									</td><td>
										<input type="range" name="scale" oninput="optSliderOnInput(this);" min="0.1" max="10" step="0.01" value="1.0" style="width: 300px;" />
									</td><td>
										<div class="optValue" name="scale_value" style="text-align: left; width: 100px;">1.0</div>
									</td></tr>
								</table>
							</div>
						</td></tr>
					</table>
				</div>
			</div>
		<!--</div>-->

		<script>
			function parseNumber(num)
			{
				return Number(parseFloat(num).toFixed(2));
			}

			function initialHelper(inputName, value, valuePostfix)
			{
				var inputElem = document.querySelector("input[name=" + inputName + "]");
				var valueElem = document.querySelector("div[name=" + inputName + "_value]");

				inputElem.value = value;
				valueElem.innerHTML = parseNumber(value) + valuePostfix;
			}

			function optResetvalue(thisElem, val)
			{
				var inputName = thisElem.getAttribute("name");
				inputName = inputName.substring(0, inputName.length - 6);
				var inputElem = document.querySelector("input[name=" + inputName + "]");
				if( val === undefined )
					inputElem.value = (inputName === "scale") ? 1 : 0;
				else
					inputElem.value = val;
				inputElem.oninput();
			}

			function optSliderOnInput(thisElem)
			{
				var valueElem = document.querySelector("div[name=" + thisElem.name + "_value]");
				var postfix = "";

				if( thisElem.name === "pitch" || thisElem.name === "yaw" || thisElem.name === "roll" )
				{
					postfix = thisElem.value + "&deg;";

					if( g_allowTransformUpdate )
					{
						var pitch = document.querySelector("input[name=pitch]");
						var yaw = document.querySelector("input[name=yaw]");
						var roll = document.querySelector("input[name=roll]");
						aaapi.system.adjustObjectRot(parseFloat(pitch.value), parseFloat(yaw.value), parseFloat(roll.value));
					}
				}
				else if( thisElem.name === "offX" || thisElem.name === "offY" || thisElem.name === "offZ" )
				{
					postfix = thisElem.value + "in";

					if( g_allowTransformUpdate )
					{
						var offX = document.querySelector("input[name=offX]");
						var offY = document.querySelector("input[name=offY]");
						var offZ = document.querySelector("input[name=offZ]");
						aaapi.system.adjustObjectOffset(parseFloat(offX.value), parseFloat(offY.value), parseFloat(offZ.value));
					}
				}
				else if( thisElem.name === "scale" )
				{
					var goodScale = parseNumber(thisElem.value);
					postfix = goodScale;

					if( g_allowTransformUpdate )
						aaapi.system.adjustObjectScale(parseFloat(goodScale));
				}

				valueElem.innerHTML = postfix;
			}

			function selectNone(container)
			{
				// deselect everything
				var selected = container.querySelector(".wlPlateSelected");
				if( selected )
				{
					selected.className = "wlPlate";
					return selected;
				}

				return;
			}

			function resetTransform()
			{
				g_allowTransformUpdate = false;
				var pitchLabel = document.querySelector("div[name=pitch_label]");
				optResetvalue(pitchLabel);

				var yawLabel = document.querySelector("div[name=yaw_label]");
				optResetvalue(yawLabel);

				g_allowTransformUpdate = true;
				var rollLabel = document.querySelector("div[name=roll_label]");
				optResetvalue(rollLabel);

				g_allowTransformUpdate = false;
				var offXLabel = document.querySelector("div[name=offX_label]");
				optResetvalue(offXLabel);

				var offYLabel = document.querySelector("div[name=offY_label]");
				optResetvalue(offYLabel);

				g_allowTransformUpdate = true;
				var offZLabel = document.querySelector("div[name=offZ_label]");
				optResetvalue(offZLabel);

				var scaleLabel = document.querySelector("div[name=scale_label]");
				optResetvalue(scaleLabel);
			}

			function selectPlate(thisElem)
			{
				selectNone(wl_transformContainer);
				thisElem.className += " wlPlateSelected";
				
				var panelName = thisElem.getAttribute("name");

				document.querySelector("#rotationPanel").style.display = (panelName === "rotateTab") ? "block" : "none";
				document.querySelector("#offsetPanel").style.display = (panelName === "offsetTab") ? "block" : "none";
				document.querySelector("#scalePanel").style.display = (panelName === "scaleTab") ? "block" : "none";
			}

			function selectNoneM(container)
			{
				// deselect everything
				var selected = container.querySelector(".selectedNamePlate");
				if( selected )
				{
					selected.className = "namePlate";
					return selected;
				}

				return;
			}

			function selectNext()
			{
				console.log("Select next.");
				var next;
				var old = selectNoneM(entryContainerElem);
				if( !!old )
				{
					if( !!old.parentNode.timerHandle )
						clearTimeout(old.parentNode.timerHandle);

					next = old.parentNode.nextSibling;
				}

				if( !!!next )
				{
					next = entryContainerElem.firstChild;//childNodes[0];
					entryContainerElem.scrollTop = 0;
				}

				if( !!next )
				{
					next.querySelector(".namePlate").className += " selectedNamePlate";
					if( (old && next === old.parentNode.nextSibling) || !!!old )
						updateScroll();

					if( category === "objects" )
						aaapi.system.objectHover(next.entry.id);

					// load this entry in 1 second, after its animation is finished.
					// (this allows you to skip past entries you don't want to load)
					next.timerHandle = setTimeout(function()
					{
						//console.log("category is " + category + " and mode is " + mode);
						if( category === "items" ) //mode === "spawn" && 
							aaapi.system.cabinetSelected(this.entry.info.id);
						else if( category !== "objects" )
							aaapi.system.modelSelected(this.entry.info.id);
						//else if( category === "objects" )
							//aaapi.system.objectSelected(this.entry.id);
						
							//console.log("xxx tea bag disabled");
					}.bind(next), 1000);
				}
			}

			function selectPrev()
			{
				var prev;
				var old = selectNoneM(entryContainerElem);
				if( !!old )
				{
					if( !!old.parentNode.timerHandle )
						clearTimeout(old.parentNode.timerHandle);

					prev = old.parentNode.previousSibling;
				}

				if( !!!prev )
				{
					prev = entryContainerElem.lastChild;
					entryContainerElem.scrollTop = entryContainerElem.scrollHeight;
				}

				if( !!prev )
				{
					prev.querySelector(".namePlate").className += " selectedNamePlate";

					if( (old && prev === old.parentNode.previousSibling) || !!!old )
						updateScroll();

					if( category === "objects" )
						aaapi.system.objectHover(prev.entry.id);

					// load this entry in 1 second, after its animation is finished.
					// (this allows you to skip past entries you don't want to load)
					prev.timerHandle = setTimeout(function()
					{
						if( category === "items" ) //mode === "spawn" && 
							aaapi.system.cabinetSelected(this.entry.info.id);
						//else if( category === "objects" )
							//aaapi.system.objectSelected(this.entry.id);
						else if( category !== "objects" )
							aaapi.system.modelSelected(this.entry.info.id);
							//console.log("xxx tea bag disabled");
					}.bind(prev), 1000);
				}
			}

			function updateScroll()
			{
				var selected = document.querySelector(".selectedNamePlate");
				if( selected )
				{
					var offset = selected.parentNode.offsetTop - entryContainerElem.scrollTop;
					var elemOffset = selected.parentNode.offsetHeight;
					var containerHeight = entryContainerElem.offsetHeight;	//window.innerHeight
					if(offset > (containerHeight / 3.0) * 2.0)
					{
						if( entryContainerElem.scrollTop + elemOffset <= entryContainerElem.scrollHeight )
							entryContainerElem.scrollTop += elemOffset;
						else
							entryContainerElem.scrollTop = entryContainerElem.scrollHeight;
					}
					else if(offset < (containerHeight / 3.0) * 1.0)
					{
						if( entryContainerElem.scrollTop - elemOffset >= 0 )
							entryContainerElem.scrollTop -= elemOffset;
						else
							entryContainerElem.scrollTop = 0;
					}
				}
			}

			function randoSelect()
			{
				return;
				// deselect everything
				var selected = document.querySelector(".selectedNamePlate");
				if( selected )
					selected.className = "namePlate";

				// select a rando one
				var potentials = document.querySelectorAll(".namePlate");
				//console.log(potentials.length);
				var randoIndex = Math.floor(Math.random() * 10) + 0;
				potentials[randoIndex].className += " selectedNamePlate";
			}

			function doStuff()
			{
				if( isDoingStuff )
					return;

				isDoingStuff = true;

				var hiddenElems = document.querySelectorAll(".hiddenElem");
				for( var i = 0; i < hiddenElems.length; i++ )
					hiddenElems[i].classList.remove("hiddenElem");
					//hiddenElems[i].style.display = "block";

				libraryBrowserContext = aaapi.system.getLibraryBrowserContext();
				category = libraryBrowserContext.category;
				titleElem = document.querySelector("#title");

				if( mode === "select" )
				{
					titleElem.innerHTML = "NEARBY OBJECTS";
					category = "objects";
				}
				else if( category === "items" )
					titleElem.innerHTML = "CABINETS";
				else// if( category === "models" )
					titleElem.innerHTML = "PROPS";

				if( mode === "move")
				{
					titleElem.innerHTML = (category === "items") ? "MOVE SHORTCUT" : "MOVE OBJECT";
					if( category === "models" )
						document.querySelector("#entryContainer").style.display = "none";
				}

				document.addEventListener("keypress", function(e)
				{
					console.log(e);
				});

				/*
				namePlateElem.style.opacity = "1.0";
						namePlateElem.style.border = "2px solid rgb(255, 255, 255)";
						namePlateElem.style.borderLeft = "20px solid rgb(255, 255, 255)";
						namePlateElem.style.borderRight = "80px solid rgb(255, 255, 255)";
				*/

		

				entryContainerElem = document.querySelector("#entryContainer");

				if( category !== "objects" )
				{
					if( libraryBrowserContext.category === "items" )
					{
						method = "find";
						searchCategory = "models";
						//console.log("HERE SEARCH AT IS: " + searchCategory);
						response = aaapi.library.findFirstLibraryEntry(searchCategory, "title", "", "dynamic", "1");
					}
					else if( mode !== "move" && libraryBrowserContext.filter === "" )
					{
						console.log("yar");
						//searchCategory = libraryBrowserContext.category;
						var searchText = libraryBrowserContext.search;
						if( searchText != "" )
						{
							method = "find";
							response = aaapi.library.findFirstLibraryEntry(category, "title", searchText);
						}
						else
						{
							method = "get";
							response = aaapi.library.getFirstLibraryEntry(searchCategory);
						}
					}
					else if( mode !== "move" )
					{
						//searchCategory = libraryBrowserContext.category;
						var searchText = libraryBrowserContext.search;
						var filterText = libraryBrowserContext.filter;
						method = "find";
						// FIXME: (maybe) This always assumes that the filter field of the item is "type".
						response = aaapi.library.findFirstLibraryEntry(category, "title", searchText, "type", filterText);
					}
				}
				else
				{
					// get the nearest models, because they are usually the ones that are unclick-able.
					searchCategory = "models";
					method = "get";
					response = aaapi.system.getNearestObjectToPlayerLook(searchCategory);
				}

				if( mode !== "move" || category === "items" )
				{
					//console.log(JSON.stringify(response));
					var queryId = response.queryId;
					var entry = response.entry;
					var entryElem;
					var prettyName;

					var entries = [];

					var count = 0;
					var max = 999;	// FIXME: arbitraty limit!!!!  Also, should get these async, not all at once.
					while( response.success && count < max )
					{
						if( category !== "models" || !entry.dynamic)
							entries.push(entry);

						if( method === "get" )
						{
							if( category === "objects" )
								response = aaapi.system.getNextNearestObjectToPlayerLook(queryId, searchCategory);
							else
								response = aaapi.library.getNextLibraryEntry(queryId, searchCategory);
						}
						else
						{
							// catetory = objects is *always* method = get, so we don't have to handle it here.
							response = aaapi.library.findNextLibraryEntry(queryId, searchCategory);
						}

						entry = response.entry;
						count++;
						//entry = aaapi.library.findNextLibraryModel();
					}
//console.log(JSON.stringify(entries));
					if( category === "items" )
					{
						entries.sort(function(a, b)
						{
							var lettersA = a.title.substring(a.title.lastIndexOf("\\") + 1).toLowerCase();
							var lettersB = b.title.substring(b.title.lastIndexOf("\\") + 1).toLowerCase();

							if( lettersA < lettersB )
								return -1;
							else if( lettersA > lettersB )
								return 1;
							else
								return 0;
						});
					}
					else if( category !== "objects" )
					{
						entries.sort(function(a, b)
						{
							/*
							var letterA = a.platforms[sourcePlatformId].file.substring(a.platforms[sourcePlatformId].file.lastIndexOf("\\") + 1)[0].toLowerCase();
							var letterB = b.platforms[sourcePlatformId].file.substring(b.platforms[sourcePlatformId].file.lastIndexOf("\\") + 1)[0].toLowerCase();

							if( letterA < letterB )
								return -1;
							else if( letterA > letterB )
								return 1;
							else
								return 0;
							*/

							var lettersA = a.platforms[sourcePlatformId].file.substring(a.platforms[sourcePlatformId].file.lastIndexOf("\\") + 1).toLowerCase();
							var lettersB = b.platforms[sourcePlatformId].file.substring(b.platforms[sourcePlatformId].file.lastIndexOf("\\") + 1).toLowerCase();

							if( lettersA < lettersB )
								return -1;
							else if( lettersA > lettersB )
								return 1;
							else
								return 0;
						});
					}

					var i;
					var max = entries.length;
					for( i = 0; i < max; i++ )
					{
						entry = entries[i];
						//console.log(JSON.stringify(entry));
						entryElem = document.createElement("div");
						entryElem.entry = entry;

						if( category === "objects" || category === "items")
							prettyName = entry.title;
						else
						{
							prettyName = entry.platforms[sourcePlatformId].file;
							prettyName = prettyName.substring(prettyName.lastIndexOf("\\") + 1);
							prettyName = prettyName.substring(0, prettyName.length - 4);
						}

						prettyName = prettyName.replace(/_/g, " ");
						prettyName = prettyName.toUpperCase();

						namePlateElem = document.createElement("div");
						namePlateElem.className = "namePlate";
						namePlateElem.innerHTML = prettyName;

						//if(entry.info.id === libraryBrowserContext.id)
						//	namePlateElem.className += " selectedNamePlate";

						entryElem.appendChild(namePlateElem);

						entryContainerElem.appendChild(entryElem);

						//console.log(JSON.stringify(entry));
						//entry = aaapi.library.findNextLibraryModel();
					}
				}

				transformInfo = aaapi.system.getTransformInfo();
				if( transformInfo.success )
				{
					var offset = transformInfo.offset;
					var rotation = transformInfo.rotation;
					var scale = transformInfo.scale;

					initialHelper("pitch", rotation.p, "&deg;");
					initialHelper("yaw", rotation.y, "&deg;");
					initialHelper("roll", rotation.r, "&deg;");

					initialHelper("offX", offset.x, "in");
					initialHelper("offY", offset.y, "in");
					initialHelper("offZ", offset.z, "in");

					initialHelper("scale", scale, "");
				}

				wl_transformContainer = document.querySelector("#wl_transform");
			}


			//if( mode === "select" )
				//setTimeout(doStuff, 500);
			//else
			//if( mode !== "select" )
				doStuff();

			//entryContainerElem.addEventListener("mousewheel", function(e)
			document.addEventListener("mousewheel", function(e)
			{
				//if( !isDoingStuff )
				//	doStuff();

				var direction = (e.wheelDelta > 0) ? -1 : 1;

				if( cmdListener.displayMode === "browse" )
				{
					if( direction > 0 )
						selectNext();
					else
						selectPrev();
				}
				else
				{
					console.log("unhandled scroll for transform!!");
				}

				//entryContainerElem.scrollTop += 100 * direction;

				e.preventDefault();
				return false;
			}, false);

/*
			setInterval(function()
			{
				randoSelect();
			}, 2000);
*/
		</script>
		<!--
		<select id="modelContainer" size=20 style="font-size: 20px; font-weight: 900; position: fixed; top: 0; bottom: 0; right: 0; margin: 0; text-align: right; border: 0; background-color: transparent;"></select>
		<script>
			//var model = aaapi.library.getFirstLibraryModel();
			//console.log(JSON.stringify(model));

			var sourcePlatformId = "-KJvcne3IKMZQTaG7lPo";

			var modelContainerElem = document.querySelector("#modelContainer");
			var model = aaapi.library.findFirstLibraryModel("", 1);
			var modelElem;
			var prettyName;
			while( model )
			{
				modelElem = document.createElement("option");
				modelElem.value = model.info.id;

				prettyName = model.platforms[sourcePlatformId].file;
				prettyName = prettyName.substring(prettyName.lastIndexOf("\\") + 1);
				prettyName = prettyName.substring(0, prettyName.length - 4);
				prettyName = prettyName.replace(/_/g, " ");
				prettyName = prettyName.toUpperCase();

				modelElem.text = prettyName;
				modelContainerElem.appendChild(modelElem);

				console.log(JSON.stringify(model));
				model = aaapi.library.findNextLibraryModel();
			}
		</script>
		-->

		<style>
			#transformMenuContainer
			{
				position: absolute;
				left: 50%;
				top: 55%;
			}

			#transformMenu
			{
				position: relative;
				left: -50%;
				/*background-color: rgb(255, 0, 0);*/
			}

			.wlContainer
			{
				font-size: 20px;
				font-weight: 900;
				margin: 0;
				text-align: right;
				border: 0;
				color: #fff;
				overflow-y: scroll;
				font-family: Arial;
			}

			.wlContainer::-webkit-scrollbar
			{
				width: 15px;
				height: 15px;
			}

			.wlContainer::-webkit-scrollbar-track
			{
				-webkit-box-shadow: inset 0 0 6px rgba(250, 50, 50, 0.7);
				border-radius: 10px;
				background-color: #000;/* rgba(250, 50, 50, 0.7);*//*rgba(100, 100, 100, 1.0);*/
			}

			.wlContainer::-webkit-scrollbar-thumb
			{
				border-radius: 10px;
				-webkit-box-shadow: inset 0 0 6px #000;/*rgba(200,200,200,1);*/
				background-color: rgba(250, 50, 50, 0.7);
			}

			.wlContainer::-webkit-scrollbar-corner
			{
				background-color: transparent;
			}

			.wlPlate
			{
				color: rgba(255, 255, 255, 0.5);
				display: inline-block;
				padding: 8px;
				background-color: rgba(0, 0, 0, 0.99);
				border-top-left-radius: 10px;
				border-bottom-left-radius: 10px;
				border: 2px solid rgba(250, 50, 50, 0.7);/*rgb(100, 100, 100);*/
				border-right: 1px solid rgba(250, 50, 50, 0.7);/*rgb(100, 100, 100);*/
				margin-bottom: 4px;
				margin-top: 4px;
				border-left: 20px solid rgba(250, 50, 50, 0.7);/*rgb(100, 100, 100);*/
				letter-spacing: 0.1em;
				font-style: italic;
				opacity: 0.8;
				text-transform: uppercase;
				-webkit-transition: border 0.5s ease-in-out, border-right 0.5s ease-in-out;
			}

			.wlPlate:hover
			{
				color: #fff;
			}

			.wlPlateSelected
			{
				color: #fff;
				-webkit-transition-delay: 0s, 0.5s;
				opacity: 1.0;
				border: 2px solid rgba(250, 50, 50, 0.9);/*rgb(255, 255, 255);*/
				border-left: 40px solid rgba(250, 50, 50, 0.9);/*rgb(255, 255, 255);*/
				border-right: 80px solid rgba(250, 50, 50, 0.9);/*rgb(255, 255, 255);*/
			}

			.optLabel, .optValue
			{
				display: inline-block;
				font-size: 40px;
				font-weight: 900;
				margin: 0;
				text-align: right;
				border: 0;
				color: #fff;
				font-family: Arial;

				/*line-height: 74px;
				font-family: Arial;
				font-size: 50px;*/
				/*padding-right: 10px;*/
				-webkit-text-stroke: 2px black;
				text-shadow:
					3px 3px 0 #000,
					-1px -1px 0 #000,
					1px -1px 0 #000,
					-1px 1px 0 #000,
					1px 1px 0 #000;
			}

			.optSliderPanel
			{
				display: inline-block;
				width: 100%;
				border-radius: 15px;
				background-color: rgba(0, 0, 0, 0.7);
				padding: 8px;
				font-size: 20px;
				font-weight: 900;
				margin: 0;
				text-align: left;
				border: 2px solid #000;
				color: #fff;
				font-family: Arial;
				letter-spacing: 0.1em;
			}
		</style>

		<style>
		input[type=range]
		{
    		-webkit-appearance: none;
    		background-color: #fff;
    		border-radius: 10px;
    		border: 2px solid black;
    		height: 14px;
			margin-top: 7px;
		}

		input[type=range]::-webkit-slider-runnable-track
		{
			border: 0;
			background-color: transparent;
		}

		input[type=range]::-webkit-slider-thumb
		{
			-webkit-appearance: none;
			width: 30px;
			height: 30px;
		    border: 2px solid #000;
		    border-radius: 50%;
		    background-color: #fff;
		}

		input[type=range]:focus::-webkit-slider-thumb
		{
			background-color: rgb(250, 50, 50);
		}

		input[type=range]:focus
		{
		    outline: none;
		}

		input[type=range]:focus::-webkit-slider-runnable-track
		{

		}
		</style>
<!--
		<link rel="stylesheet" type="text/css" href="rangeslider.css">
		<script src="jquery-2.1.3.min.js"></script>
		<script src="rangeslider.min.js"></script>
		<script>
		    // Initialize a new plugin instance for all
		    // e.g. $('input[type="range"]') elements.
		    $('input[type="range"]').rangeslider({
				// Feature detection the default is `true`.
				// Set this to `false` if you want to use
				// the polyfill also in Browsers which support
				// the native <input type="range"> element.
				polyfill: true,

				// Default CSS classes
				rangeClass: 'rangeslider',
				disabledClass: 'rangeslider--disabled',
				horizontalClass: 'rangeslider--horizontal',
				verticalClass: 'rangeslider--vertical',
				fillClass: 'rangeslider__fill',
				handleClass: 'rangeslider__handle',

				// Callback function
				onInit: function() {},

				// Callback function
				onSlide: function(position, value) {},

				// Callback function
				onSlideEnd: function(position, value) {}
		    });

			// Destroy all plugin instances created from the
			// e.g. $('input[type="range"]') elements.
			$('input[type="range"]').rangeslider('destroy');

			// Update all rangeslider instances for all
			// e.g. $('input[type="range"]') elements.
			// Usefull if you changed some attributes e.g. `min` or `max` etc.
			$('input[type="range"]').rangeslider('update', true);
		</script>
	-->
	</body>
</html>