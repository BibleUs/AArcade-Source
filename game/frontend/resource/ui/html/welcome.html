<html>
	<head>
		<link rel="stylesheet" type="text/css" href="asset://ui/hud.css"></link>
		<script src="asset://ui/hud.js"></script>
	</head>
	<body>

		<script>
			function doPause()
			{
				window.location='asset://ui/pause.html';
			}
		</script>
		
		<div style="pointer-events: none; position: absolute; left: 0; top: 0; right: 0; bottom: 0;">
		<table style="width: 100%; height: 100%;">
		<tr ><td valign="middle" align="center">
		<div style="display: inline-block;">

		<script>
			var windowHeaderHTML = arcadeHud.generateWindowHeaderHTML("Main Menu", "", true, true, "", "aaapi.system.deactivateInputMode();");
			document.write(windowHeaderHTML);

			function getStarted()
			{
				window.location='asset://ui/importSteamGames.html?uiback=' + encodeURIComponent("window.location='asset://ui/welcome.html';");
			}
		</script>

		<center>
			<table style="width: 100%;">
				<tr>
					<td valign="top" style="width: 1px;">

			<!-- Tutorial -->
			<div id="tutorialNagButton" style="display: none;">
				<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorOneHoverShadedBackground aaTextColorOneColor aaThemeColorOneLowBorderColor helpNote" value="Tutorial" onclick="window.location='asset://ui/betasplash.html';" help="Introduction to Anarchy Arcade." />
			</div>

			<!-- Steam Games -->
			<div id="steamgamesNagButton" style="display: none;">
				<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorOneHoverShadedBackground aaTextColorOneColor aaThemeColorOneLowBorderColor helpNote" value="Steam Games" onclick="getStarted();" help="Import your Steam games from your Steam profile to get started." />
			</div>

			<!-- World Info, Leave -->
			
			<div class="aaOnlyIfMapLoaded">
				<!-- Host Session -->
				<div class="aaOnlyIfMapLoaded aaOnlyIfUniverseNotConnected" style="display: none;">
					<div class="aaTextSizeFontSize aaTextColorTwoColor" style="display: none; font-family: Arial; font-weight: bold; text-align: center; white-space: nowrap;">Singleplayer</div>
					<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Host" onclick="window.location='asset://ui/hostSession.html';" help="Host your arcade as a multiplayer server." />
					<hr class="aaThemeColorOneBackgroundColor aaThemeColorOneBorderColor" />
				</div>
				
				<!-- Session Info-->
				<div class="aaOnlyIfMapLoaded aaOnlyIfUniverseConnected" style="display: none;">
					<div class="aaTextSizeFontSize aaTextColorTwoColor" style="display: none; font-family: Arial; font-weight: bold; text-align: center; white-space: nowrap;">Multiplayer</div>
					<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorOneHoverShadedBackground aaTextColorOneColor aaThemeColorOneLowBorderColor helpNote" value="Invite" id="sessionButton" onclick="viewSession();" help="You are currently in an ONLINE session. Get your invite link here." />
					<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Disconnect" onclick="askDisconnectSession();" help="Disconnect from the online session & return to local singleplayer mode." /><!--<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Chat" onclick="window.location = 'asset://ui/chatbox.html';" help="Chat with users in the session." />-->
					<hr class="aaThemeColorOneBackgroundColor aaThemeColorOneBorderColor" />
				</div>
			</div>

			<table style="width: 100%;" cellspacing="0" cellpadding="0">
				<tr><td>
					<!--
						<iframe src="http://192.168.0.188:8888/" style="width: 100%; height: 100px;"></iframe>
					<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Node Manager (TEST)" onclick="window.location='asset://ui/nodeManager.html';" help="Testing menu stuff." />
					-->
					<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Play" onclick="window.location='asset://ui/play.html';" help="Load a different world map." />
					<!--
					<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Leave World" onclick="aaapi.system.disconnect();" help="Leave this world & return to the main menu." />
					-->
					<!--
					<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="World Info" onclick="window.location='asset://ui/worldInfo.html';" help="View mount & workshop info about this world." />
					-->
				</td><td class="aaOnlyIfMapLoadedx" style="display: none;">
					<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Leave" onclick="aaapi.system.disconnect();" help="Leave this world & return to the main menu." />
				</td></tr>
			</table>

			<!-- Pause -->
			<div class="aaOnlyIfMapLoaded">
				<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Pause" onclick="doPause();" help="Pause AArcade so it doesn't hurt your performance in other games." /><br />
			</div>

			<!-- Library
			<div class="aaOnlyIfMapLoaded">
				<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Library" onclick="goToLibrary();" help="Browse & manage your personal library." /><br />
			</div> -->

			<!-- Panoramic Viewer
			<div class="aaOnlyIfMapLoaded">
				<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Panoramic Viewer" onclick="window.location = 'panoview.html';" help="Browse & manage your personal library." /><br />
			</div> -->

			<!-- Multiplayer
			<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Multiplayer" onclick="" help="" disabled /><br />
			 -->

			<!-- Options -->
			<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Options" onclick="window.location='asset://ui/options.html';" help="Configure AArcade & the Source engine." /><br />

			<!-- tester
			<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Tester" onclick="aaapi.network.extractOverviewTGA();" help="Tetser" /><br /> -->

			<!-- Addons
			<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Addons" onclick="window.location='asset://ui/addons.html';" help="Manage your workshop & other addons, or import Steam games, maps & models, or legacy content." /><br /> -->

			<!-- Feedback -->
			<!-- <input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Feedback" onclick="window.location='asset://ui/feedback.html';" help="Ask for help, report a bug, make a suggestion, or leave a review of AArcade." /><br /> -->

			<!-- Quit -->
			<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Quit" onclick="aaapi.system.quit();" help="Shutdown Anarchy Arcade and return to Windows." />

			<!--<input type="button" class="aaButton aaBigButton aaTitleTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor helpNote" value="Disconnect" onclick="aaapi.system.disconnect();" help="Leave this universe & return to a local session." />-->

					</td>
				</tr>
			</table>
		</center>

		<script>
			var windowFooterHTML = arcadeHud.generateWindowFooterHTML();
			document.write(windowFooterHTML);
		</script>

		</div>
		</td></tr>
		</table>
		</div>

		<a href="javascript:location.reload();" class="devReload">&bull;&nbsp;</a>

		<script>
			// https://www.htmlgoodies.com/html5/javascript/calculating-the-difference-between-two-dates-in-javascript.html
			function daysBetween( date1, date2 ) {
			  //Get 1 day in milliseconds
			  var one_day=1000*60*60*24;

			  // Convert both dates to milliseconds
			  var date1_ms = date1;//.getTime();
			  var date2_ms = date2;//.getTime();

			  // Calculate the difference in milliseconds
			  var difference_ms = date2_ms - date1_ms;
			    
			  // Convert back to days and return
			  return difference_ms/one_day; 
			}

			var tutorialNag = (localStorage.getItem("tutorial_nag") != 0);
			if( tutorialNag )
				document.querySelector("#tutorialNagButton").style.display = "block";

			var steamgamesNag = localStorage.getItem("steamgames_nag");
			if( steamgamesNag != "0" )
			{
				if( !!!steamgamesNag )
					steamgamesNag = 0;
				else
					steamgamesNag = parseInt(steamgamesNag);

				// now check when the last nag was
				var lastSteamgamesNag = localStorage.getItem("last_steamgames_nag");

				var shouldSteamgamesNag = false;
				if( !!!lastSteamgamesNag )
					shouldSteamgamesNag = true;
				else
				{
					var dateA = new Date(parseInt(lastSteamgamesNag));
					var dateB = new Date();
					var dif = daysBetween(dateA.getTime(), dateB.getTime());
					
					if( dif >= steamgamesNag )
						shouldSteamgamesNag = true;
				}

				if(shouldSteamgamesNag)
					document.querySelector("#steamgamesNagButton").style.display = "block";
			}
		</script>

		<script>
			function disconnectSession()
			{
				aaapi.network.restartNetwork();
				setTimeout(function()
				{
					window.location.reload();
				}, 100);
			}

			function viewSession()
			{
				window.location = 'asset://ui/online.html?uiback=' + encodeURIComponent("window.location='asset://ui/welcome.html';");
			}

			function yesDisconnectSession()
			{
				disconnectSession();
			}

			function noDisconnectSession()
			{
				console.log("nope");
			}

			function askDisconnectSession()
			{
				createModalPrompt("Are You Sure?", "This will end your online session & return you to singleplayer mode.", "yesDisconnectSession();", "noDisconnectSession();");
			}

			var aaModalPromptMenu;
			function createModalPrompt(title, text, yesAction, noAction)
			{
				if( !!aaModalPromptMenu )
				{
					console.log("ERROR: A modal menu is already being displayed!");
					return;
				}

				// Lets be modal.
				var modalContainer = document.createElement("div");
				modalContainer.style.cssText = "position: fixed; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.8);";
				modalContainer.addEventListener("click", function(e)
				{
					/*
					var isChild = false;
					var childNode = e.target;
					while(!!childNode)
					{
						childNode = childNode.parentNode;
						if( childNode === e.currentTarget )
						{
							isChild = true;
							break;
						}
					}
					*/

					if( e.currentTarget !== e.target )
					{
						// the modal window itself is clicked
						/*
						if( !isChild )
						{
							console.log("propo stopped");
							e.preventDefault();
							e.stopImmediatePropagation();//Immediate
						}
						*/
						return;
					}
					else
					{
						if( !!!aaModalPromptMenu.flashInterval )
						{
							aaModalPromptMenu.flashInterval = setInterval(function()
							{
								var titleRow = this.querySelector("tr");
								var titleBarElems = titleRow.querySelectorAll("td");
								var titleBarElem;

								if( !!!this.flashCount )
								{
									for( var i = 0; i < titleBarElems.length; i++ )
									{
										titleBarElem = titleBarElems[i];
										if( titleBarElem.classList.contains("aaThemeColorOneHighBackgroundColor") )
										{
											titleBarElem.classList.remove("aaThemeColorOneHighBackgroundColor");
											titleBarElem.classList.add("aaThemeColorOneBackgroundColor");
										}
									}

									clearInterval(this.flashInterval);
									delete this.flashInterval;
								}
								else
								{
									for( var i = 0; i < titleBarElems.length; i++ )
									{
										titleBarElem = titleBarElems[i];
										if( titleBarElem.classList.contains("aaThemeColorOneHighBackgroundColor") )
										{
											titleBarElem.classList.remove("aaThemeColorOneHighBackgroundColor");
											titleBarElem.classList.add("aaThemeColorOneBackgroundColor");
										}
										else if(titleBarElem.classList.contains("aaThemeColorOneBackgroundColor"))
										{
											titleBarElem.classList.remove("aaThemeColorOneBackgroundColor");
											titleBarElem.classList.add("aaThemeColorOneHighBackgroundColor");
										}
									}

									this.flashCount--;
								}
							}.bind(aaModalPromptMenu), 100);

							aaModalPromptMenu.flashCount = 6;
						}
					}
				}.bind(modalContainer), true);

				var modalHTML = "";

				// header
				var modalYPos = (window.innerHeight / 3) + "px";
				var modalWindowHeaderHTML = arcadeHud.generateWindowHeaderHTML(title, "margin-left: auto; margin-right: auto; top: " + modalYPos + "; width: 600px;", true, true, "", "");
				modalHTML += modalWindowHeaderHTML;

				// body
				modalHTML += '<div class="aaWindowPaneContent aaThemeColorTwoHighBackgroundColor aaThemeColorTwoLowBorderColor aaTitleTextSizeFontSize aaTextColorTwoColor">';
				//modalHTML += "<form id='nodeNameForm' style='margin: 0;'>";
				/*
				modalHTML += "<table style='margin-left: 0; margin-right: 0;'>\
					<tr>\
						<td>\
							<img src='clock.png' style='width: 78px;' />\
						</td>\
						<td style='padding-left: 15px;'>";*/
						//	<div class='aaTextSizeFontSize aaTitleText aaThemeColorOneColor' style='white-space: normal;'>Here are notes on features I'm currently working on improving.<br /><br />Thank you for having patience.</div>\

				modalHTML += "<div style='font-family: Arial; text-align: justify; white-space: normal;' class='aaTextSizeFontSize aaTextColorTwoColor'>";
				modalHTML += text;
				//modalHTML += "<input id='nodeNameInput' type='text' class='aaTitleTextSizeFontSize' />";
				modalHTML += "</div>";
				//modalHTML += "</td></tr></table>";
				modalHTML += "</div>";

				modalHTML += '\
					<table class="aaWindowActions">\
						<tr>\
							<td>\
							</td>\
							<td style="width: 1%; white-space: nowrap;">\
								<input type="button" class="aaButton aaTextSizeFontSize aaThemeColorOneHoverShadedBackground aaTextColorOneColor aaThemeColorOneLowBorderColor" style="padding: 6px; padding-left: 12px; padding-right: 12px;" value="Disconnect" />\
								<input type="button" class="aaButton aaTextSizeFontSize aaThemeColorTwoHoverShadedBackground aaTextColorTwoColor aaThemeColorTwoLowBorderColor" style="padding: 6px; padding-left: 12px; padding-right: 12px;" value="Cancel" />\
							</td>\
						</tr>\
					</table>\
				';

				//modalHTML += "</form>";

				// footer
				var modalWindowFooterHTML = arcadeHud.generateWindowFooterHTML();
				modalHTML += modalWindowFooterHTML;

				modalContainer.innerHTML = modalHTML;
				aaModalPromptMenu = modalContainer.querySelector(".aaWindow");
				document.body.appendChild(modalContainer);
/*
				var nodeNameInput = document.body.querySelector("#nodeNameInput");
				nodeNameInput.focus();
				var nodeNameForm = document.body.querySelector("#nodeNameForm");
				nodeNameForm.addEventListener("submit", function(e)
				{
					e.preventDefault();

					if( this.value === "" )
						this.focus();
					else
					{
						aaModalPromptMenu.parentNode.parentNode.removeChild(aaModalPromptMenu.parentNode);
						aaModalPromptMenu = undefined;

						confirmedSaveNewNode(this.value);
					}
				}.bind(nodeNameInput), true);
*/

				var buttons = modalContainer.querySelectorAll(".aaWindowActions input[type='button']");
				buttons[0].addEventListener("click", function(e)
				{
					aaModalPromptMenu.parentNode.parentNode.removeChild(aaModalPromptMenu.parentNode);
					aaModalPromptMenu = undefined;

					eval(yesAction);
				}, true);

				buttons[1].addEventListener("click", function(e)
				{
					aaModalPromptMenu.parentNode.parentNode.removeChild(aaModalPromptMenu.parentNode);
					aaModalPromptMenu = undefined;

					eval(noAction);
				}, true);
			}
/*
			var sessionButtonElem = document.querySelector("#sessionButton");
			var numUsers = aaapi.network.getNumUsers();

			var sessionButtonText = "Online (" + numUsers + ")";
			sessionButtonElem.value = sessionButtonText;
*/
		</script>
	</body>
</html>